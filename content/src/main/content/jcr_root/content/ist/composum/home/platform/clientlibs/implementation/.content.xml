<?xml version="1.0" encoding="UTF-8"?>
<jcr:root xmlns:cpp="http://sling.composum.com/pages/1.0"
        xmlns:jcr="http://www.jcp.org/jcr/1.0"
        xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
        xmlns:sling="http://sling.apache.org/jcr/sling/1.0"
        jcr:primaryType="cpp:Page">
    <jcr:content
            jcr:primaryType="cpp:PageContent"
            sling:resourceType="composum/pages/components/page"
            jcr:description="&lt;p>Content Management and more - create your own CMS - fast and flexible - implementation details of the Composum Client Libraries - bring back the fun to Content Management&lt;/p>"
            jcr:title="Client Libraries Implementation"
            template="/apps/ist/composum/templates/page/content">
        <main
                jcr:primaryType="cpp:Container"
                sling:resourceType="composum/pages/components/container/parsys">
            <row
                    jcr:primaryType="cpp:Container"
                    sling:resourceType="composum/pages/components/container/row"
                    columns="-12-">
                <column-0
                        jcr:primaryType="cpp:Container"
                        sling:resourceType="composum/pages/components/container/row/column">
                    <text_65583
                            jcr:primaryType="cpp:Element"
                            sling:resourceType="composum/pages/components/element/text"
                            text="&amp;nbsp;Internal notes for pages development only - not to be published."
                            textAlignment="center"/>
                    <title_65585
                            jcr:primaryType="cpp:Element"
                            sling:resourceType="composum/pages/components/element/title"
                            textAlignment="left"
                            title="Domain model (excerpt):">
                        <image
                                jcr:primaryType="nt:unstructured"/>
                    </title_65585>
                    <table_65588
                            jcr:primaryType="cpp:Element"
                            sling:resourceType="composum/pages/components/composed/table"
                            bordered="{Boolean}true"
                            striped="{Boolean}true">
                        <row_65599
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65600
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    head="{Boolean}true"
                                    text="Class"/>
                            <column_65605
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    head="{Boolean}true"
                                    text="Description"/>
                        </row_65599>
                        <row_65610
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65611
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibElement"/>
                            <column_65616
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="Common interface for all elements of a client library / category"/>
                        </row_65610>
                        <row_65621
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65622
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="Clientlib"/>
                            <column_65627
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="Client library"/>
                        </row_65621>
                        <row_65632
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65633
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibResourceFolder"/>
                            <column_65638
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="The type-specific folder of a client library, or any of the sub-folders"/>
                        </row_65632>
                        <row_65643
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65644
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibCategory"/>
                            <column_65649
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="Represents a category of client libraries"/>
                        </row_65643>
                        <row_65654
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65655
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibFile"/>
                            <column_65660
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="File embedded or dependency of a client library"/>
                        </row_65654>
                        <row_65665
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65666
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibExternalUri"/>
                            <column_65671
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="A dependency to an external URL"/>
                        </row_65665>
                        <row_65676
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65677
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibLink"/>
                            <column_65682
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="A link that is rendered in the page, referencing either a client library, client library category or specific file"/>
                        </row_65676>
                        <row_65687
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65688
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibRef"/>
                            <column_65693
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="An entry at a ClientlibResourceFolder, referencing a client library, client library category or specific file. Possibly gives a version range when referencing a file."/>
                        </row_65687>
                    </table_65588>
                    <title_65698
                            jcr:primaryType="cpp:Element"
                            sling:resourceType="composum/pages/components/element/title"
                            textAlignment="left"
                            title="Services and other classes:">
                        <image
                                jcr:primaryType="nt:unstructured"/>
                    </title_65698>
                    <table_65701
                            jcr:primaryType="cpp:Element"
                            sling:resourceType="composum/pages/components/composed/table"
                            bordered="{Boolean}true"
                            striped="{Boolean}true">
                        <row_65712
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65713
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    head="{Boolean}true"
                                    text="Class"/>
                            <column_65718
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    head="{Boolean}true"
                                    text="Description"/>
                            <column_65723
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    head="{Boolean}true"
                                    text="Implementations"/>
                        </row_65712>
                        <row_65728
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65729
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibProcessor"/>
                            <column_65734
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="Modifies the content of resources embedded in a client library"/>
                            <column_65739
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="GzipProcessor,..."/>
                        </row_65728>
                        <row_65744
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65745
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibRenderer"/>
                            <column_65750
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="Collects the ClientlibLinks for a client library"/>
                            <column_65758
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"/>
                        </row_65744>
                        <row_65764
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65765
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="JavascriptProcessor"/>
                            <column_65770
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibProcessor and ClientlibRenderer specifically for Javascript (JS)."/>
                            <column_65775
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="DefaultJavascriptProcessor"/>
                        </row_65764>
                        <row_65780
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65781
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="CssProcessor"/>
                            <column_65786
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibProcessor and ClientlibRenderer specifically for CSS."/>
                            <column_65792
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="YUICssProcessor (minification)"/>
                        </row_65780>
                        <row_65797
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65798
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="LinkRenderer"/>
                            <column_65803
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibRenderer for other resources than JS/CSS."/>
                            <column_65808
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="DefaultLinkRenderer"/>
                        </row_65797>
                        <row_65813
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65814
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="RendererContext"/>
                            <column_65819
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="Request scoped context used during rendering"/>
                            <column_65825
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"/>
                        </row_65813>
                        <row_65831
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65832
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ProcessorContext"/>
                            <column_65837
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="Request scoped context used during processing (delivery of embedded content)"/>
                            <column_65842
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"/>
                        </row_65831>
                        <row_65848
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65849
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibConfiguration"/>
                            <column_65854
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="Configuration information used in rendering and processing"/>
                            <column_65859
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibConfigurationService"/>
                        </row_65848>
                        <row_65864
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65865
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibService"/>
                            <column_65870
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="Various internal functionality about client libraries."/>
                            <column_65875
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="DefaultClientlibService"/>
                        </row_65864>
                        <row_65880
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65881
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibServlet"/>
                            <column_65889
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="Delivers embedded resources for client libraries."/>
                            <column_65894
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"/>
                        </row_65880>
                        <row_65900
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65901
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibCategoryServlet"/>
                            <column_65909
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="Delivers embedded resources for client library categories."/>
                            <column_65914
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"/>
                        </row_65900>
                        <row_65920
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65921
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibTag"/>
                            <column_65926
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="Renders links according to a client lib definition - links to files, ClientlibServlet or ClientlibCategoryServlet."/>
                            <column_65931
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"/>
                        </row_65920>
                        <row_65937
                                jcr:primaryType="cpp:Element"
                                sling:resourceType="composum/pages/components/composed/table/row">
                            <column_65938
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="ClientlibVisitor"/>
                            <column_65943
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="Implements the visitor pattern to traverse a client library or category with its embedded or dependent ClientlibElements"/>
                            <column_65948
                                    jcr:primaryType="cpp:Element"
                                    sling:resourceType="composum/pages/components/composed/table/cell"
                                    text="AbstractClientlibVisitorRenderingVisitorProcessingVisitorLastUpdateTimeVisitor"/>
                        </row_65937>
                    </table_65701>
                    <title_65965
                            jcr:primaryType="cpp:Element"
                            sling:resourceType="composum/pages/components/element/title"
                            textAlignment="left"
                            title="Implementation notes">
                        <image
                                jcr:primaryType="nt:unstructured"/>
                    </title_65965>
                    <text_65967
                            jcr:primaryType="cpp:Element"
                            sling:resourceType="composum/pages/components/element/text"
                            text="The rendering process of the ClientlibTag by the appropriate ClientlibRenderer has two steps. First, the RenderingVisitor traverses the tree of resources referenced by a client library, and collects all ClientlibLinks that need to be rendered into the page. That is, all files, clientlibs and clientlib categories that are given as dependencies of the rendered client library or the referenced client libraries. The links that already have been rendered in the page by previous calls to the ClientlibTag are kept in the request scoped RendererContext. In a second step the write the links into the page according to the configurable typespecific format."
                            textAlignment="text"/>
                    <title_65984
                            jcr:primaryType="cpp:Element"
                            sling:resourceType="composum/pages/components/element/title"
                            textAlignment="left"
                            title="Open Problems">
                        <image
                                jcr:primaryType="nt:unstructured"/>
                    </title_65984>
                    <text_65986
                            jcr:primaryType="cpp:Element"
                            sling:resourceType="composum/pages/components/element/text"
                            text="&#xa;                &lt;ul>&#xa;                &#xa;                    &lt;li>&#xa;                    A request with &quot;refresh cache&quot; deletes the cache file for a client lib and forces other requests to wait until it is recreated. A solution might be writing it to a temporary file first.&#xa;                    &lt;/li>&#xa;                &#xa;                    &lt;li>&#xa;                    When the cache becomes out of date, all requests have to wait until it is recreated. Possible remedy: deliver old file during recreation. Requires writing to a temporary file; locking mechanism unclear.&#xa;                    &lt;/li>&#xa;                &#xa;                    &lt;li>&#xa;                    Interaction of cache file recreation in a cluster? Local filesystem? (Would serve client libraries with variable last modification date, though.)&#xa;                    &lt;/li>&#xa;                &#xa;                &lt;/ul>&#xa;            "
                            textAlignment="left"/>
                    <text_65996
                            jcr:primaryType="cpp:Element"
                            sling:resourceType="composum/pages/components/element/text"
                            text=" "
                            textAlignment="text"/>
                </column-0>
            </row>
        </main>
        <top
                jcr:primaryType="cpp:Container"
                sling:resourceType="composum/pages/components/container/parsys"
                parentInheritanceCancelled="{Boolean}true">
            <title
                    jcr:primaryType="cpp:Element"
                    sling:resourceType="composum/pages/components/element/title"
                    title="Client Libraries Implementation Notes">
                <image
                        jcr:primaryType="nt:unstructured"
                        imageRef="/content/ist/composum/assets/background/history_of_pi.jpg"/>
            </title>
        </top>
        <navigation
                jcr:primaryType="nt:unstructured"
                title="Implementation"/>
    </jcr:content>
</jcr:root>
